<!DOCTYPE html>
<html>
<head>
<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="js/pace.js"></script>
<script src="./js/scripts.js"></script>
<script src="./js/timeline_client.js"></script>
<script src="./js/time_format.js"></script>
<script language="javascript" type="text/javascript" src="./js/jquery.jsmovie.1.4.1.min.js" ></script>
<link rel="Stylesheet" type="text/css" href="./css/style.css" />
<!-- the CSS for Smooth Div Scroll -->
<link rel="Stylesheet" type="text/css" href="./css/smoothDivScroll.css" />

<!-- by @derSchepp https://github.com/Schepp/CSS-Filters-Polyfill -->
<script>
	  // this is important for IEs
	  var polyfilter_scriptpath = './js/';
</script>
<script src="./js/cssParser.js"></script>
<script src="./js/css-filters-polyfill.js"></script>

<!-- MODAL CONTENT -->

<script type="text/javascript" src="./js/jquery.reveal.js"></script>
<script src="./js/jquery-ui-1.8.23.custom.min.js" type="text/javascript"></script>
<script src="./js/jquery.mousewheel.min.js" type="text/javascript"></script>
<!-- jQuery Kinectic (1.5) used for touch scrolling -->
<script src="./js/jquery.kinetic.js" type="text/javascript"></script>
<script src="./js/jquery.smoothdivscroll-1.3-min.js" type="text/javascript"></script>

<!-- Safe to remove this -->
<script type="text/javascript">
	
	
	// Initialize the plugin with no custom options
	$(document).ready(function () {
		// BEGIN SCROLLABLE FUNCTIONS
		$("div#make_me_scrollable").smoothDivScroll({
			touchScrolling: true,
			hotSpotScrolling: false
		});
		
		
		
		 $('#rte').jsMovie({
        sequence : "#.png",    //the #### will be replaced with 0001,0002,0003,...
        folder   : "images/img/1/",       //this is the path where the script can find the image sequence
        from     : 1,               //the #### will start to replace with 0001
        to       : 400,              //the #### will start to replace with 0040
        width    : 350,             
        height   : 350,            
        showPreLoader : false,       //we do want to see a preloader animation
        playOnLoad : false,         //we don't want to have the movie play after the images have been loaded automatically
        // the preloader animation is located in the folder "images/img/loader.png"
        // it is a 4x4 image matrix with each image of 40px by 40px
        loader   : {path:"images/img/loader.png",height:40,width:40,rows:4,columns:4}
        
    });
  
 
   $('#rte').jsMovie("addClip","Hello",1,400);
  
   $('#rte').jsMovie("playClips"); 
   
   
   
      $('#Net2').jsMovie({
        sequence : "#.png",    //the #### will be replaced with 0001,0002,0003,...
        folder   : "/images/img/1/",       //this is the path where the script can find the image sequence
        from     : 1,               //the #### will start to replace with 0001
        to       : 400,              //the #### will start to replace with 0040
        width    : 350,            
        height   : 350,           
        showPreLoader : false,       //we do want to see a preloader animation
        playOnLoad : false,         //we don't want to have the movie play after the images have been loaded automatically
        // the preloader animation is located in the folder "images/img/loader.png"
        // it is a 4x4 image matrix with each image of 40px by 40px
        loader   : {path:"/images/img/loader.png",height:40,width:40,rows:4,columns:4}
        
    });
  
    // make frame 1 to frame 20 to a clip an call it Hello. Pa
   $('#Net2').jsMovie("addClip","Hello",1,400);
  
   $('#Net2').jsMovie("playClips"); 
    
    
    /*  $('#TV3').jsMovie({
        sequence : "#.png",    //the #### will be replaced with 0001,0002,0003,...
        folder   : "img/3/",       //this is the path where the script can find the image sequence
        from     : 1,               //the #### will start to replace with 0001
        to       : 400,              //the #### will start to replace with 0040
        width    : 350,            
        height   : 350,             
        showPreLoader : false,       //we do want to see a preloader animation
        playOnLoad : false,         //we don't want to have the movie play after the images have been loaded automatically
        // the preloader animation is located in the folder "images/img/loader.png"
        // it is a 4x4 image matrix with each image of 40px by 40px
        loader   : {path:"images/img/loader.png",height:40,width:40,rows:4,columns:4}
        
    });
  
    // make frame 1 to frame 20 to a clip an call it Hello. Pause the animation for 2 seconds before the next clip is being played
   $('#TV3').jsMovie("addClip","Hello",1,400);

   $('#TV3').jsMovie("playClips"); 
   
   
         $('#TG4').jsMovie({
        sequence : "#.png",    //the #### will be replaced with 0001,0002,0003,...
        folder   : "img/2/",       //this is the path where the script can find the image sequence
        from     : 1,               //the #### will start to replace with 0001
        to       : 400,              //the #### will start to replace with 0040
        width    : 350,             
        height   : 350,             
        showPreLoader : false,       //we do want to see a preloader animation
        playOnLoad : true,         //we don't want to have the movie play after the images have been loaded automatically
        // the preloader animation is located in the folder "images/img/loader.png"
        // it is a 4x4 image matrix with each image of 40px by 40px
        loader   : {path:"images/img/loader.png",height:40,width:40,rows:4,columns:4}
        
    });
  
    // make frame 1 to frame 20 to a clip an call it Hello. 
   $('#TG4').jsMovie("addClip","Hello",1,400);

   $('#TG4').jsMovie("playClips"); */
		// END SCROLLABLE FUNCTIONS
		
		//Full example of format  here --> you can see that we need a start time and and end time in this specific format. Declan you need to tack on the datetimes to the end of the url http://digitalinc.ie/ScreenSpace/get-tv-shows.php?tv_start_time=27-10-2013%2021:20:00&tv_end_time=27-10-2013%2023:40:00
		
		// BEGIN REFRESH FUNCTIONS
		//Beginning of the refresh funtion: This calculates the times, creates a new URL and gets the TV show data. 
		function refresh(){

		
			//This is Declan's code for calculating the current time
			// get the current time
			var now = new Date();
			// add an hour, for 30 min block use ( then.getMinutes() + 30 );  the amount of time makes a big deifference to what you get back and might need to change based on time of day, shorter in the morning?
			var then = new Date(now);
			then.setHours(then.getHours()+1);
			var url = 'http://digitalinc.ie/ScreenSpace/get-tv-shows.php?tv_start_time=' + now.format("dd-mm-yyyy%20HH:00:00") + '&tv_end_time=' + then.format("dd-mm-yyyy%20HH:00:00");
			//End of Declan's code for calculating the time
			
			//get the TV shows based on the URL
			$.get(url, function(data){
				
			//This is an example of what we're going to output --> <li class="tv-show" data-id="1" data-name="Love/Hate" data-hashtag="#lovehate" data-channel="RTE1" data-start-time="27/10/2013 21:30:00" data-end-time="27/10/2013 22:30:00">Love/Hate</li>
				
			//clear the container and then append the TV shows to it. 		
				
			//Assigning of the 4 Channels its own Div
				$('ul.tv-shows-container').html('');
				$(data.tv_shows[0]).each(function(show){
					$('ul.tv-shows-container').append('<li class="tv-show" data-id="' + this.tv_show_id + '" data-name="' + this.name + '" data-hashtag="' + this.hashtag + '" data-channel="' + this.station + '" data-start-time="' + this.start_time + '" data-end-time="' + this.stop_time + '" data-count="' + this.count + '">'+ this.station + ' ' + this.hashtag + ': ' + this.count +'</li>'); 
				});
				
		$('ul.tv-shows-container1').html('');
				$(data.tv_shows[1]).each(function(show){
					$('ul.tv-shows-container1').append('<li class="tv-show" data-id="' + this.tv_show_id + '" data-name="' + this.name + '" data-hashtag="' + this.hashtag + '" data-channel="' + this.station + '" data-start-time="' + this.start_time + '" data-end-time="' + this.stop_time + '" data-count="' + this.count + '">'+ this.station +' ' + this.hashtag + ': ' + this.count + '</li>'); 
				});		
				
		/*$('ul.tv-shows-container2').html('');
				$(data.tv_shows[2]).each(function(show){
					$('ul.tv-shows-container2').append('<li class="tv-show" data-id="' + this.tv_show_id + '" data-name="' + this.name + '" data-hashtag="' + this.hashtag + '" data-channel="' + this.station + '" data-start-time="' + this.start_time + '" data-end-time="' + this.stop_time + '" data-count="' + this.count + '">' + this.station + ' ' + this.hashtag + ': ' + this.count  + '</li>'); 
				});				
				
	
	
			$('ul.tv-shows-container3').html('');
				$(data.tv_shows[3]).each(function(show){
					$('ul.tv-shows-container3').append('<li class="tv-show" data-id="' + this.tv_show_id + '" data-name="' + this.name + '" data-hashtag="' + this.hashtag + '" data-channel="' + this.station + '" data-start-time="' + this.start_time + '" data-end-time="' + this.stop_time + '" data-count="' + this.count + '">'+ this.station + ' ' + this.hashtag + ' : ' + this.count +'</li>'); 

				});	*/		
				
			});
		}
		
		
		//get the data

		refresh();
		//every minute go back and get the data about the TV shows from the database...
		setInterval(refresh, 60000); //here's where I'm setting the interval in miliseconds. 
		// END REFRESH FUNCTIONS
		
		//BEGIN TWITTER CLIENT FUNCTIONS
		// Run when Search button is clicked
		$('#search_button').click(function(){
			
			// Display a progress indicator
			$('#search_results').html(' Searching Twitter...');
			
			// Get the value of the input field
			// Encode it for use in a URL
			var search_value = encodeURIComponent($('input[name=search_terms]').val());
			
			// Send the search terms to the server in an Ajax request
			// This URL is for illustration only
			// You MUST change it to your server
			
			var date = new Date();
			var hours = date.getHours();
			var day = date.getDate();
			var month = date.getMonth() + 1; //Months are zero based
			var year = date.getFullYear();
			
			date = year + "-" + month + "-" + day;// + " " + hours + ":00:00";
			
			
			$.ajax({
				url: 'http://digitalinc.ie/ScreenSpace/search.php?q=' + search_value + '&count=10&until=' + date,
				success: function(data){
										
					// Display the results
					$('#search_results').html(data);
				}
			})
		})
		//END TWITTER CLIENT FUNCTIONS
	
	});
		
		  
</script>
<title>Screen Space UI</title>
</head>

<body>
<div class="navbar">
  <div class="birdicon"><img src="images/left Icon.png" width="200" height="98"  alt=""/></div>
  <div class="title">WHATS ON NOW</div>
  <div class="birdicon"><img src="images/spacer.png" width="80" height="92"  alt=""/></div>
  <div class="title"> CUSTOMISE </div>
  <div class="infoicon"> <img src="images/info-icon.png" width="200" height=98  alt=""/> </div>
</div>

<!-- <div id="search_box">
        <input name="search_terms" autofocus/>
        <button id="search_button"  a href="#" data-reveal-id="my_modal" data-animation="fade">Search</button><!-- END search_button -->
</div>
<!-- END search_box --> 

<!--
  	<a href="#" data-reveal-id="my_modal" data-animation="fade">Show the Twitter Feed </a>
    -->

<div id="my_modal" class="reveal-modal">
  <div id="make_me_scrollable">
    <div id="search_results"></div>
    <!-- END search_results --> 
  </div>
  <!-- END make_me_scrollable --> 
  <a class="close-reveal-modal">&#215;</a> </div>
<!-- END reveal-modal -->

<ul class="tv-shows-container">
</ul>
<div id="rte"></div>
<div id="Net2"></div>
<ul class="tv-shows-container1"></ul>
</body>
</html>
